# TG-Text.ru - React приложение для обработки текста

Веб-приложение на React с авторизацией и API для обработки текста: перемешивание слов и исключение однокоренных слов.

## Структура проекта

- `src/` - Исходный код React приложения
  - `pages/` - Страницы приложения (Home, Login, Register)
  - `components/` - React компоненты
  - `contexts/` - React контексты (AuthContext)
  - `styles/` - CSS стили
- `app.js` - Node.js API сервер
- `package.json` - Зависимости проекта
- `vite.config.js` - Конфигурация Vite для сборки
- `nginx_tg-text.ru.conf` - Конфигурация Nginx
- `deploy.ps1` - Скрипт деплоя на сервер

## Установка и запуск локально

### Требования
- Node.js >= 14.0.0
- npm или yarn

### Установка зависимостей
```bash
npm install
```

### Запуск API сервера
```bash
npm start
# или
node app.js
```

API будет доступен на `http://localhost:5000`

### Запуск React приложения в режиме разработки
```bash
npm run dev
```

Приложение будет доступно на `http://localhost:3000`

### Сборка для production
```bash
npm run build
```

Собранные файлы будут в папке `dist/`

## Деплой на сервер

### Использование deploy.ps1

1. Убедитесь, что SSH ключ настроен (см. `create_ssh_key.ps1`)
2. Запустите деплой:
```powershell
.\deploy.ps1
```

Скрипт автоматически:
- Соберет React приложение
- Закоммитит изменения в Git
- Отправит на сервер через Git push
- Сервер автоматически соберет и развернет приложение через `post-receive` hook

### Настройка базы данных

На сервере выполните:
```bash
mysql -u root -p < init_database.sql
```

Это создаст:
- Базу данных `tg_text_db`
- Таблицу `users` для авторизации
- Таблицу `user_requests` для истории запросов

## API Endpoints

### Авторизация
- `POST /api/auth/register` - Регистрация нового пользователя
- `POST /api/auth/login` - Вход пользователя

### Обработка текста
- `POST /api/process` - Обработка текста (перемешивание слов)
- `GET /api/history` - История запросов (требует авторизации)

### Системные
- `GET /api/health` - Проверка работоспособности API

## Особенности

- **React Router** - Клиентская маршрутизация
- **JWT авторизация** - Безопасная аутентификация
- **MySQL** - Хранение данных пользователей и истории запросов
- **SPA routing** - Поддержка прямых ссылок в React Router через Nginx

## Структура базы данных

### Таблица `users`
- `id` - ID пользователя
- `email` - Email (уникальный)
- `password_hash` - Хеш пароля
- `name` - Имя пользователя
- `created_at` - Дата регистрации

### Таблица `user_requests`
- `id` - ID запроса
- `user_id` - ID пользователя (связь с users)
- `user_ip` - IP адрес
- `request_text` - Исходный текст
- `exclude_words` - Слова для исключения
- `result_text` - Результат обработки
- `created_at` - Время создания

## Переменные окружения

Для API сервера можно настроить через переменные окружения:

- `PORT` - Порт API сервера (по умолчанию 5000)
- `DB_HOST` - Хост MySQL (по умолчанию localhost)
- `DB_USER` - Пользователь MySQL (по умолчанию tg_text_user)
- `DB_PASSWORD` - Пароль MySQL (по умолчанию tg_text_password_2024)
- `DB_NAME` - Имя базы данных (по умолчанию tg_text_db)
- `JWT_SECRET` - Секретный ключ для JWT (измените в production!)

## Лицензия

MIT
